<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Readings</title>
		<link href="styleReadingsPage.css" rel="stylesheet" type="text/css">
		<script type="text/javascript" src="sideBar.json"></script>
		<div class="navigation">
  			<!--<img src="menu_button2.png" alt="" width="30" height="30" class="menu_btn" onClick="openNav()"/> -->
  			
		</div>
		<h4 class="logo" onClick="openNav()"><a herf="#">CRADLE</a></h4>
		
		<script>
        function callAwsLambdaFunction() {
			document.getElementById('server2').innerHTML = localStorage.getItem("result");
										
            var http = new XMLHttpRequest();
			
			http.responseType = 'json';
			
            http.open("POST", "https://oyseokpdbi.execute-api.us-east-2.amazonaws.com/prod/cradleDownloadTest", true);
			
			
			var params= JSON.stringify({'httpMethod': 'POST', 'body':{'testType': localStorage.getItem("result"), 'PID': document.getElementById("PatientID").value}});
			//var paramsToPass = json.loads(params);

            http.setRequestHeader("Content-type", "application/json; charset=utf-8");

            http.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
					var struct = this.response;
						var patientID = struct['body'].Items[0].PID;
				
						document.getElementById("server").innerHTML = patientID;
						//window.onload.getElementById("server").innerHTML = patientID;
					}
                else {
                    document.getElementById("server").innerHTML = "invalid";
                }
            };
           // xhttp.open("POST", "https://oyseokpdbi.execute-api.us-east-2.amazonaws.com/prod/cradleLogin", true);
            http.send(params);

        }
    </script>
		
	</head>
	
	<body>
		<div id="mySidenav" class="sidenav">
 			 <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  			<a href="#">About</a>
  			<a href="sensors.html">Sensors</a>
  			<a href="#">Analysis</a>
		</div>

		<div id="main">
			<h4>Please enter a PID to view results</h4>
				<form method="post">
					<input type="text" name="v" placeholder="PID" required="required" id="PatientID"/>
					<input type="button" class="btn-primary btn-block btn-large tag" style="text-decoration:none;" value="View" id="submit" onClick="callAwsLambdaFunction()"/>
					<!--<button onClick= "callAwsLambdaFunction()"> click me!</button> -->
				</form>
			<h5 id="server">Testing...</h5>
			<h5 id="server2">Testing...</h5>
			
		</div>
			
    </body>
</html>